<!DOCTYPE html>

<html>
<head>
		<title>g</title>
  <script>
  function writeViewPort() {
            var ua = navigator.userAgent;
            if (ua.indexOf("Android") >= 0 && ua.indexOf("AppleWebKit") >= 0) {
                var webkitVersion = parseFloat(ua.slice(ua.indexOf("AppleWebKit") + 12));
                // targets android browser, not chrome browser (http://jimbergman.net/webkit-version-in-android-version/)
                if (webkitVersion < 535) {
                    document.write('<meta name="viewport" content="initial-scale=1" />');
                }
            }
        }

        writeViewPort();
    window.addEventListener("load", function() {
				var loadingText = document.getElementById("progress");
				var canvas = document.querySelector("canvas");
				var engine = new BABYLON.Engine(canvas);
				var scene = new BABYLON.Scene(engine);
				BABYLON.SceneLoader.ImportMesh("", "", "CybroxSize.babylon", scene, function(newMeshes) {
                  scene.executeWhenReady(function() {
                      loadingText.style.display = "none";
                  })
                  
        window.myscene = scene;
                  
				//Create Lights
        var light = new BABYLON.DirectionalLight("light", new BABYLON.Vector3(-1, -2, -1), scene);
				light.position = new BABYLON.Vector3(20.311, 35, -17.5);
				light.diffuse = new BABYLON.Color3(1, 1, 1);
				light.specular = new BABYLON.Color3(1, 1, 1);
				light.intensity = 0.75;
				
				var light0 = new BABYLON.DirectionalLight("light0", new BABYLON.Vector3(1, -2, 1), scene);
				light0.position = new BABYLON.Vector3(35, 35, 0);
        light0.diffuse = new BABYLON.Color3(1, 1, 1);
				light0.specular = new BABYLON.Color3(1, 1, 1);
				light0.intensity = 0.75;        
				
        var light1 = new BABYLON.DirectionalLight("light1", new BABYLON.Vector3(-1, -2, -1), scene);
				light1.position = new BABYLON.Vector3(-20.311, 35, -17.5);
        light1.diffuse = new BABYLON.Color3(1, 1, 1);
				light1.specular = new BABYLON.Color3(1, 1, 1);
				light1.intensity = 0.75;

				//Call Meshes
        var platform = scene.getMeshByName("platformtop");
		scene.removeMesh(platform);
		var cylinder = scene.getMeshByName("Platform_Body_Cylinder.006");
		scene.removeMesh(cylinder);
        var carbody = scene.getMeshByName("bodyshell");
        var cabin = scene.getMeshByName("innercabin");
        var leftdoor = scene.getMeshByName("leftdoorpanel");
        var rthinge = scene.getMeshByName("rtdoor-hinge");
        var lfthinge = scene.getMeshByName("Lftdoor-hinge");
        var rightdoor = scene.getMeshByName("rightdoorpanel");
        var hoodhinges = scene.getMeshByName("hood_hinges");
        var hood = scene.getMeshByName("cybroxhood");
        var hatchdoorhinges = scene.getMeshByName("rear_door_hinges");
        var hatchdoor = scene.getMeshByName("rear_door_panel");
        var mainspoiler = scene.getMeshByName("rear_door_spoiler");
        var secondspoiler = scene.getMeshByName("rear_door_lowerwing");
        var sopilerposts = scene.getMeshByName("rear_door_spoilersupport");
        var sopilerfins = scene.getMeshByName("rear_door_fin");
        var windscreen = scene.getMeshByName("windscreenh");
        var driverwindow = scene.getMeshByName("windowdriver");
        var triangwindowrt = scene.getMeshByName("windowtrirt");
        var rearwindscreen = scene.getMeshByName("rear_door_windscreen");
        var triangwindowlft = scene.getMeshByName("windowtrilft");
        var passengerwindow = scene.getMeshByName("windowpass");
        var mesh = scene.getMeshByName("cyborxlightglass");
        var headlamp = scene.getMeshByName("headlampgls");
        var headlamphsert = scene.getMeshByName("headlamphousert");
        var headlamphself = scene.getMeshByName("headlamphouselft");
        var largebeamrt = scene.getMeshByName("largebeamrgt");
        var midbeamrgt = scene.getMeshByName("midbeamrt");
        var rtindicator = scene.getMeshByName("indicatorrgt");
        var rtheadlamping = scene.getMeshByName("headlampringrt");
        var lftmidbeam = scene.getMeshByName("medbeamlft");
        var rgtindicator = scene.getMeshByName("lftindicator");
        var largebeamlft = scene.getMeshByName("largeheadlamplft");
        var lftheadlampring = scene.getMeshByName("headlampringlft");
        var lftfrontrim = scene.getMeshByName("rimlfront");
        var lftbackrim = scene.getMeshByName("rimlback");
        var rtfrontrim = scene.getMeshByName("rimrfront");
        var rtbackrim = scene.getMeshByName("rimrback");
        var metalknobs = scene.getMeshByName("metalrings");
        var hatchmetalparts = scene.getMeshByName("rear_door_metals");
        var rtfronttire = scene.getMeshByName("frontrttire");
        var lftfronttire = scene.getMeshByName("frontlfttire");
        var rtreartire = scene.getMeshByName("rearrttire");
        var lftreartire = scene.getMeshByName("rearlfttire");
        var backaxel = scene.getMeshByName("axler");
        var cabbelly = scene.getMeshByName("dashboardcab");
        var frontaxel = scene.getMeshByName("axlef");
        var carengine = scene.getMeshByName("engineblock");
        var fpipes = scene.getMeshByName("frontpipes");
        var bpipes = scene.getMeshByName("rearpipes");
        var muff = scene.getMeshByName("muffler");
        var rearview = scene.getMeshByName("rearviewmirror");
        var rtwingmirror = scene.getMeshByName("wingmirrorrt");
        var lftwingmirror = scene.getMeshByName("wingmirrorlft");
        var skybox = scene.getMeshByName("Envir");
        scene.removeMesh(skybox);
		scene.clearColor = new BABYLON.Color3(1, 1, 1);
		//Stop Animation
			//scene.stopAnimation(rthinge);
			//scene.stopAnimation(lfthinge);
			//scene.stopAnimation(hatchdoorhinges);
			//scene.stopAnimation(hoodhinges);
		/*	
			// Left Door On Click Animation Trigger
			leftdoor.actionManager = new BABYLON.ActionManager(scene);
			var action = new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, lfthinge, 0, 160, false);
			action.then(new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, lfthinge, 160, 321, false));
			leftdoor.actionManager.registerAction(action);  
        
  			// Right Door On Click Animation Trigger
			rightdoor.actionManager = new BABYLON.ActionManager(scene);
			var action = new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, rthinge, 0, 160, false);
			action.then(new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, rthinge, 160, 321, false));
			rightdoor.actionManager.registerAction(action);       

		// Hatch Door On Click Animation Trigger
			hatchdoor.actionManager = new BABYLON.ActionManager(scene);
			var action = new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, hatchdoorhinges, 0, 160, false);
			action.then(new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, hatchdoorhinges, 160, 321, false));
			hatchdoor.actionManager.registerAction(action); 

 		// Hood On Click Animation Trigger
			hood.actionManager = new BABYLON.ActionManager(scene);
			var action = new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, hoodhinges, 0, 160, false);
			action.then(new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, hoodhinges, 160, 321, false));
			hood.actionManager.registerAction(action);       
       
     // Spoiler On Click Animation Trigger
			mainspoiler.actionManager = new BABYLON.ActionManager(scene);
			var action = new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, hatchdoorhinges, 0, 160, false);
			action.then(new BABYLON.PlayAnimationAction(BABYLON.ActionManager.OnPickTrigger, hatchdoorhinges, 160, 321, false));
			mainspoiler.actionManager.registerAction(action);    
       */
        
        //Create CarBody Material
        var carbodypaintMaterial = new BABYLON.StandardMaterial("carbodypaintMaterial", scene);
        carbodypaintMaterial.reflectionTexture = new BABYLON.CubeTexture("skybox/skybox", scene);
				carbodypaintMaterial.specularColor = new BABYLON.Color3(0.5, 0.1, 0.1);
        carbodypaintMaterial.specularPower = 100;
        carbodypaintMaterial.diffuseTexture = new BABYLON.Texture("Red.jpg", scene);
        carbodypaintMaterial.ambientTexture = new BABYLON.Texture("Red.jpg", scene);
        carbodypaintMaterial.reflectionTexture.level = 0.45;//Select the level (0.0 > 1.0) of the reflection
        carbody.material = carbodypaintMaterial;
        leftdoor.material = carbodypaintMaterial;
        rightdoor.material = carbodypaintMaterial;   
        hood.material = carbodypaintMaterial; 
        hatchdoor.material = carbodypaintMaterial; 
        mainspoiler.material = carbodypaintMaterial;
        secondspoiler.material = carbodypaintMaterial;
        
                
        //Chrome Material
        var chromeMaterial = new BABYLON.StandardMaterial("chromemetalMaterial", scene);
        chromeMaterial.reflectionTexture = new BABYLON.MirrorTexture("chromeTexture", 1024, scene, true);
        chromeMaterial.reflectionTexture = new BABYLON.CubeTexture("skybox/skybox", scene);
				chromeMaterial.specularColor = new BABYLON.Color3(1, 1, 1);
        chromeMaterial.specularPower = 500
        chromeMaterial.diffuseColor = new BABYLON.Color3(1, 1, 1);
        chromeMaterial.ambientTexture = new BABYLON.Texture("brushedmetal.jpg", scene);
        chromeMaterial.ambientTexture.level = 0.5;//Select the level (0.0 > 1.0) of the reflection
        chromeMaterial.reflectionTexture.level = 0.5;//Select the level (0.0 > 1.0) of the reflection
        headlamphsert.material = chromeMaterial;
        headlamphself.material = chromeMaterial;
        largebeamrt.material = chromeMaterial;
        midbeamrgt.material = chromeMaterial;
        rtindicator.material = chromeMaterial;
        rtheadlamping = chromeMaterial;
				lftmidbeam.material = chromeMaterial;
				rgtindicator.material = chromeMaterial;
				largebeamlft.material = chromeMaterial;
				lftheadlampring.material = chromeMaterial;
				metalknobs.material = chromeMaterial;
				rtbackrim.material = chromeMaterial;
				rtfrontrim.material = chromeMaterial;
				lftbackrim.material = chromeMaterial;
				lftfrontrim.material = chromeMaterial;
				hatchmetalparts.material = chromeMaterial;
				sopilerposts.material = chromeMaterial;
				sopilerfins.material = chromeMaterial;
        hoodhinges.material = chromeMaterial;
        
        
        //Platform Material
        /*var platformMaterial = new BABYLON.StandardMaterial("platformMaterial", scene);
        platformMaterial.reflectionTexture = new BABYLON.MirrorTexture("platformTexture", 1024, scene, true);
        platformMaterial.reflectionTexture.mirrorPlane = new BABYLON.Plane(0, -0.0001, 0, 0);
        platformMaterial.reflectionTexture.renderList = [carbody, leftdoor, rightdoor, rtfronttire, rtreartire, lftreartire, lftfronttire, lftfrontrim, lftbackrim, rtfrontrim, rtbackrim, backaxel, cabbelly, frontaxel, carengine, fpipes, bpipes, muff, skybox, cabin];
        platformMaterial.specularColor = new BABYLON.Color3(0, 0, 0);
        platformMaterial.diffuseColor = new BABYLON.Color3(0.1, 0.1, 0.1);
        platformMaterial.ambientTexture = new BABYLON.Texture("white.jpg", scene);
        platformMaterial.reflectionTexture.level = 0.3;//Select the level (0.0 > 1.0) of the reflection
        platform.material = platformMaterial;*/
			
        //Mesh
        var meshMaterial = new BABYLON.StandardMaterial("meshMaterial", scene);
        meshMaterial.reflectionTexture = new BABYLON.MirrorTexture("meshTexture", 1024, scene, true);
        meshMaterial.reflectionTexture.mirrorPlane = new BABYLON.Plane(0, 0, 0, 0);
        meshMaterial.reflectionTexture.renderList = [skybox];
        meshMaterial.diffuseTexture = new BABYLON.Texture("mesh.png", scene);
				meshMaterial.diffuseTexture.hasAlpha = true;
        meshMaterial.alpha = 0.5;        
        meshMaterial.reflectionTexture.level = 0.5;//Select the level (0.0 > 1.0) of the reflection
        mesh.material = meshMaterial;
                
        //Create Mirror Material
        var mirrorMaterial = new BABYLON.StandardMaterial("mirrorMaterial", scene);
        mirrorMaterial.reflectionTexture = new BABYLON.MirrorTexture("mirrorTexture", 512, scene, true);
        mirrorMaterial.reflectionTexture.mirrorPlane = new BABYLON.Plane(1, 0, 0, 0);
        mirrorMaterial.reflectionTexture.renderList = [skybox];
        mirrorMaterial.specularColor = new BABYLON.Color3(0, 0, 0);
        mirrorMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0);
        mirrorMaterial.ambientColor = new BABYLON.Color3(0, 0, 0);
        mirrorMaterial.reflectionTexture.level = 1;//Select the level (0.0 > 1.0) of the reflection
        rearview.material = mirrorMaterial;
        rtwingmirror.material = mirrorMaterial;
        lftwingmirror.material = mirrorMaterial;

 //Car Tint Glass Window
        var transglassMaterial = new BABYLON.StandardMaterial("transglassMaterial", scene);
        transglassMaterial.reflectionTexture = new BABYLON.MirrorTexture("transglassTexture", 1024, scene, true);
        transglassMaterial.reflectionTexture.mirrorPlane = new BABYLON.Plane(0, 0, 0, 0);
        transglassMaterial.reflectionTexture.renderList = [skybox];
        transglassMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0);
        transglassMaterial.alpha = 0.7;        
        transglassMaterial.reflectionTexture.level = 0.7;//Select the level (0.0 > 1.0) of the reflection
        windscreen.material = transglassMaterial;
        driverwindow.material = transglassMaterial;
        triangwindowrt.material = transglassMaterial;   
        rearwindscreen.material = transglassMaterial; 
        triangwindowlft.material = transglassMaterial;
        passengerwindow.material = transglassMaterial;

	     	//Environment Material (Skybox)
				var skyboxMaterial = new BABYLON.StandardMaterial("skybox", scene);
				skyboxMaterial.backFaceCulling = false;
				skyboxMaterial.reflectionTexture = new BABYLON.CubeTexture("skybox/skybox", scene);
				skyboxMaterial.reflectionTexture.coordinatesMode = BABYLON.Texture.SKYBOX_MODE;
				skyboxMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0);
				skyboxMaterial.specularColor = new BABYLON.Color3(0, 0, 0);
				skybox.material = skyboxMaterial;
	
	
 // Shadows
			var shadowGenerator = new BABYLON.ShadowGenerator(2048, light);
			shadowGenerator.getShadowMap().renderList.push(carbody, cabbelly, hood, hatchdoor, lftfrontrim, lftbackrim, rtfrontrim, rtbackrim, rtfronttire, lftfronttire, rtreartire, lftreartire, carengine, muff, mainspoiler);
			shadowGenerator.useVarianceShadowMap = true;
			//platform.receiveShadows = true;		
			hatchdoor.receiveShadows = true;	
		
		var shadowGenerator2 = new BABYLON.ShadowGenerator(2048, light0);
			shadowGenerator.getShadowMap().renderList.push(carbody, cabbelly, hood, hatchdoor, lftfrontrim, lftbackrim, rtfrontrim, rtbackrim, rtfronttire, lftfronttire, rtreartire, lftreartire, carengine, muff, mainspoiler);
			shadowGenerator.useVarianceShadowMap = true;
			//platform.receiveShadows = true;
			hatchdoor.receiveShadows = true;
		
		var shadowGenerator3 = new BABYLON.ShadowGenerator(2048, light1);
			shadowGenerator.getShadowMap().renderList.push(carbody, cabbelly, hood, hatchdoor, lftfrontrim, lftbackrim, rtfrontrim, rtbackrim, rtfronttire, lftfronttire, rtreartire, lftreartire, carengine, muff, mainspoiler);
			shadowGenerator.useVarianceShadowMap = true;
			//platform.receiveShadows = true;
			hatchdoor.receiveShadows = true;
		
				
			    for (var index = 0; index < scene.materials.length; index++) {
scene.materials[index].backFaceCulling = false;
}	      
      //Camera           
				var camera = new BABYLON.ArcRotateCamera("Camera", -Math.PI / 2, 1.5, 8, BABYLON.Vector3.Zero(), scene);
				camera.lowerBetaLimit = 0.1;
        camera.upperBetaLimit = (Math.PI / 2) * 0.9;
				camera.lowerRadiusLimit = 4;
        camera.upperRadiusLimit = 8;
				//camera.attachControl(canvas, false);
            
        //Camera Rotate
        scene.registerBeforeRender(function(){
        scene.getCameraByID("Camera").alpha += 0.003;
    });
        engine.runRenderLoop(function() {
          scene.render()
        })
      },
       // Here is the 'onProgress' method that will update the HTML element
      function(evt) {
          if (evt.lengthComputable) {
              loadingText.innerHTML = "Loading, please wait..." + (evt.loaded * 100 / evt.total).toFixed() + "%";
          } else {
              dlCount = evt.loaded / (1024 * 1024);
              loadingText.innerHTML = "Loading, please wait..." + Math.floor(dlCount * 100.0) / 100.0 + " MB already loaded.";
          }
      })
    })
    

  </script>
  <script src="babylon.max.js"></script>
  <script src="hands.js"></script>
  <style>
    html {
      height: 100%;
    }

    body {
      margin: 0;
      height: 100%;
    }

    canvas {
      display: block;
      height: 100%;
      width: 100%;
	  position: fixed;
    }
  </style>
</head>
<body>
<div id="progress"
     style="width:100%; height:100%;color:white;background-color:white;text-align:center;padding-top:200px;font-size:2em;font-family: sans-serif"></div>
  <canvas>
  </canvas>
</body>
</html>